---
sort: 4
---

# Terraform Count vs For_Each


```danger
Dont use count.
```

### 1. Terraform Count.

```terraform
# main.tf

resource "null_resource" "listvariable_count" {
    count = length(var.simplelist)
     triggers = {
        value =  var.simplelist[count.index]
    }   
}
```

```console

  # null_resource.listvariable_count[0] will be created
  + resource "null_resource" "listvariable_count" {
      + id       = (known after apply)
      + triggers = {
          + "value" = "item1"
        }
    }

  # null_resource.listvariable_count[1] will be created
  + resource "null_resource" "listvariable_count" {
      + id       = (known after apply)
      + triggers = {
          + "value" = "item2"
        }
    }

  # null_resource.listvariable_count[2] will be created
  + resource "null_resource" "listvariable_count" {
      + id       = (known after apply)
      + triggers = {
          + "value" = "item3"
        }
    }
```

If I now remove Item1 from the list:

```
  # null_resource.listvariable_count[0] must be replaced
-/+ resource "null_resource" "listvariable_count" {
      ~ id       = "8580541850219725515" -> (known after apply)
      ~ triggers = { # forces replacement
          ~ "value" = "item1" -> "item2"
        }
    }

  # null_resource.listvariable_count[1] must be replaced
-/+ resource "null_resource" "listvariable_count" {
      ~ id       = "6751414926727791590" -> (known after apply)
      ~ triggers = { # forces replacement
          ~ "value" = "item2" -> "item3"
        }
    }

  # null_resource.listvariable_count[2] will be destroyed
  # (because index [2] is out of range for count)
  - resource "null_resource" "listvariable_count" {
      - id       = "2150514161108105462" -> null
      - triggers = {
          - "value" = "item3"
        } -> null
    }
```

### 2. Terraform For_each.

```terraform
# main.tf

resource "null_resource" "listvariable_for_each" {
    for_each = {for v in var.simplelist: v => v}
     triggers = {
        value =  each.value
    }   
}
```

```console

  # null_resource.listvariable_for_each["item1"] will be created
  + resource "null_resource" "listvariable_for_each" {
      + id       = (known after apply)
      + triggers = {
          + "value" = "item1"
        }
    }

  # null_resource.listvariable_for_each["item2"] will be created
  + resource "null_resource" "listvariable_for_each" {
      + id       = (known after apply)
      + triggers = {
          + "value" = "item2"
        }
    }

  # null_resource.listvariable_for_each["item3"] will be created
  + resource "null_resource" "listvariable_for_each" {
      + id       = (known after apply)
      + triggers = {
          + "value" = "item3"
        }
    }

```

If I now remove Item2 from the list:

```console
  # null_resource.listvariable_for_each["item1"] will be destroyed
  # (because key ["item1"] is not in for_each map)
  - resource "null_resource" "listvariable_for_each" {
      - id       = "162396972649776379" -> null
      - triggers = {
          - "value" = "item1"
        } -> null
    }
```

